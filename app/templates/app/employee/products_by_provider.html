{% extends 'app/base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block js %}
<script>
    var order = JSON.parse(getCookie('order'))
    if (order == undefined){
        order = {}
        console.log('Order Created!', order)
        document.cookie ='order=' + JSON.stringify(order) + ";domain=;path=/"
    }
    console.log('order:', order)
</script>
<script src="{% static 'app/js/order_provider.js' %}"></script>
{% endblock %}


{% block title %}Solicitar productos{% endblock %}

{% block contenido %}

<div class="row">
    <div class="col">
        <a class="btn btn-primary" href="{% url 'product_request' %}">
            <i class="bi bi-caret-left-fill"></i>            
            Volver
        </a>
    </div>
    <div class="col d-flex justify-content-end">
        <a class="btn btn-primary" href="#">Generar orden de compra</a>
    </div>

</div>


<h1 class="text-center">Solicitar productos a {{provider.nombre_empresa}}</h1>
<br>

<div class="row">
    <form class="form-inline" method="GET">
        {{ productRequestFilter.form|crispy }}
        <br>
        <button onclick= "deleteOrder()" type="submit" class="btn btn-outline-primary">Filtrar</button>
    </form>
</div>

<div class="row">
    {% for i in products %}
    <div class="col-3">
        {% if i.imagen_url %}
        <img class="thumbnail" src="{{i.imagen_url.url}}">
        {% else %}
        <img class="thumbnail" src="{% static 'app/img/noimage.png' %}">
        {% endif %}
        <div class="product-text">
            <h6>{{i.id_marca}}</h6>
            <h5><strong>{{i.producto}}</strong></h5>
            <h6>Stock: {{i.stock}}</h6>
            <h6 style="display: inline-block">Precio proveedor: ${{i.precio_proveedor}}</h6>            
            <hr>
            <button data-product={{i.id_producto}} data-provider={{i.id_proveedor}} data-action="add" class="btn btn-primary update-order">Agregar</button>
        </div>
    </div>
    {% endfor %}
</div>


{% endblock contenido %}
